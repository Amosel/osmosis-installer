name: Test Installer (Client)

on:
  push:
    branches:
      - main
      - dev
  pull_request:
    branches:
      - main
      - dev

jobs:
  install:
    name: test-installer-client
    runs-on: ubuntu-latest

    env:
      TERM: xterm

    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest]
        arch: [amd64, arm64]
        network: [osmosis-1, osmo-test-5]

    steps:
      - 
        name: Checkout Repository
        uses: actions/checkout@v3
      - 
        name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      - 
        name: Run Installer
        run: |
          python installer.py \
            --install client \
            --network ${{ matrix.network }} \
            --home ${{ runner.temp }}/.osmosisd \
            --moniker osmosis \
            --overwrite
      - 
        name: Run osmosisd
        run: |
          osmosisd status --home ${{ runner.temp }}/.osmosisd
